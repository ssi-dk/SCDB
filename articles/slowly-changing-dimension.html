<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Slowly Changing Dimension methodology • SCDB</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Slowly Changing Dimension methodology">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SCDB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/SCDB.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/benchmarks.html">SCDB: Benchmarks</a></li>
    <li><a class="dropdown-item" href="../articles/slowly-changing-dimension.html">Slowly Changing Dimension methodology</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ssi-dk/SCDB/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Slowly Changing Dimension methodology</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ssi-dk/SCDB/blob/v0.5.0/vignettes/slowly-changing-dimension.Rmd" class="external-link"><code>vignettes/slowly-changing-dimension.Rmd</code></a></small>
      <div class="d-none name"><code>slowly-changing-dimension.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.5.1     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.0.2     </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span></code></pre></div>
<p>A slowly changing dimension is a concept in data warehousing which
refers to data which may change over time, but at an irregular
schedule.</p>
<div class="section level2">
<h2 id="type-1-and-type-2-history">Type 1 and Type 2 history<a class="anchor" aria-label="anchor" href="#type-1-and-type-2-history"></a>
</h2>
<p>For example, consider the following table of forecasts for a number
of cities:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Current date: 2023-09-28</span></span>
<span><span class="va">forecasts</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   City        Forecast</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> New York          20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Los Angeles       23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Seattle           16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Houston           34</span></span></code></pre></div>
<p>The following day, the forecasts will have changed, and — barring the
occasional data hoarder — the existing data is no longer relevant.</p>
<p>In this example, most (if not all) of the values of the
<code>Forecast</code> column will change with each regular update.
Putting it into other words, the table is a <em>snapshot</em><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;A &lt;em&gt;snapshot&lt;/em&gt; is a static view of (part of) a
database at a specific point in time&lt;/p&gt;"><sup>1</sup></a> of
forecasts at the last time of update.</p>
<p>The following day, the forecasts naturally change:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Current date: 2023-09-29</span></span>
<span><span class="va">forecasts2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   City        Forecast</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> New York          18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Los Angeles       25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Seattle           17</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Houston           34</span></span></code></pre></div>
<p>We could choose to update the forecasts table so that it would always
contain the current data. This is what is referred to as Type 1
methodology <span class="citation">(Kimball and Ross 2013)</span>.</p>
<p>Databases are thankfully a rather efficient way of storing and
accessing data, so instead of discarding the values from the previous
day, we append the new data to those of the previous day. Also, in order
to keep our data organized, we add a column with the date of the
forecast, aptly named <code>ForecastDate</code>.</p>
<p>The full table of forecasts for the two days now looks like below,
and we are slowly building a full history of forecasts:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forecasts_full</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 3</span></span></span>
<span><span class="co">#&gt;   City        Forecast ForecastDate</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> New York          20 2023-09-28  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Los Angeles       23 2023-09-28  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Seattle           16 2023-09-28  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Houston           34 2023-09-28  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> New York          18 2023-09-29  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Los Angeles       25 2023-09-29  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> Seattle           17 2023-09-29  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> Houston           34 2023-09-29</span></span></code></pre></div>
<p>Managing historical data by inserting new data in this manner is
often referred to as Type 2 methodology or Type 2 history.</p>
<p>Our table now provides much more information for the user through
filtering:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Current forecasts</span></span>
<span><span class="va">forecasts_full</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_max</a></span><span class="op">(</span><span class="va">ForecastDate</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">!</span><span class="st">"ForecastDate"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   City        Forecast</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> New York          18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Los Angeles       25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Seattle           17</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Houston           34</span></span>
<span></span>
<span><span class="co"># Forecasts for a given date</span></span>
<span><span class="va">forecasts_full</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ForecastDate</span> <span class="op">==</span> <span class="st">"2023-09-28"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 3</span></span></span>
<span><span class="co">#&gt;   City        Forecast ForecastDate</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> New York          20 2023-09-28  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Los Angeles       23 2023-09-28  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Seattle           16 2023-09-28  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Houston           34 2023-09-28</span></span>
<span></span>
<span><span class="co"># Full history for a given city</span></span>
<span><span class="va">forecasts_full</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">City</span> <span class="op">==</span> <span class="st">"New York"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   City     Forecast ForecastDate</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> New York       20 2023-09-28  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> New York       18 2023-09-29</span></span></code></pre></div>
<p>Now, we note that the forecast for Houston has not changed between
the two days.</p>
<p>In order to keep our data as minimized as possible, we modify the
table again, now expanding <code>ForecastDate</code> into
<code>ForecastFrom</code> and <code>ForecastUntil</code>.</p>
<p>Our table of forecasts now looks like this:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forecasts_scd</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 4</span></span></span>
<span><span class="co">#&gt;   City        Forecast ForecastFrom ForecastUntil</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> New York          20 2023-09-28   2023-09-29   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Los Angeles       23 2023-09-28   2023-09-29   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Seattle           16 2023-09-28   2023-09-29   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Houston           34 2023-09-28   <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> New York          18 2023-09-29   <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Los Angeles       25 2023-09-29   <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> Seattle           17 2023-09-29   <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>For now, the <code>ForecastUntil</code> value is set to
<code>NA</code>, as it is not known when these rows will “expire” (if
ever). This also makes it easy to identify currently valid data.</p>
<p>Adding a new column to save a single row of data naturally seems a
bit overkill, but as the number of rows in the data set increases
indefinitely, this solutions scales much better.</p>
</div>
<div class="section level2">
<h2 id="a-timeline-of-timelines">A “timeline of timelines”<a class="anchor" aria-label="anchor" href="#a-timeline-of-timelines"></a>
</h2>
<p>Let’s now introduce additional information and see how managing
slowly changing dimensions enables us to easily navigate large amounts
of data over large periods of time.</p>
<p>Imagine a town of several thousand citizens, with a town hall
maintaining a civil registry of names and addresses of every citizen,
updated daily with any changes submitted by the citizens, each of whom
having an individual identification number.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;If this concept seems very familiar, you may have heard
of &lt;a href="https://en.wikipedia.org/wiki/Personal_identification_number_(Denmark)" class="external-link"&gt;the
Danish central civil registry&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a></p>
<p>The data is largely static, as a very small fraction of citizens move
on any given day, but it is of interest to keep data relatively
up-to-date. This is where managing a slowly changing dimension becomes
very powerful, compared to full incremental backups.</p>
<p>One day, Alice Doe meets <a href="https://xkcd.com/327/" class="external-link">Robert
“Bobby” Tables</a>, and they move in together:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">addresses</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 8</span></span></span>
<span><span class="co">#&gt;      ID GivenName Surname Address    MovedIn    MovedOut   ValidFrom  ValidUntil</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 Alice     Doe     Donut Pla… 1989-06-26 <span style="color: #BB0000;">NA</span>         1989-06-26 2021-03-08</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     2 Robert    Tables  Rainbow R… 1989-12-13 <span style="color: #BB0000;">NA</span>         1989-12-13 <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1 Alice     Doe     Donut Pla… 1989-06-26 2021-03-01 2021-03-08 <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1 Alice     Doe     Rainbow R… 2021-03-01 <span style="color: #BB0000;">NA</span>         2021-03-08 <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>First thing to notice is that the registry is not updated in
real-time, as citizens may have been late in registering a change of
address. This can be seen when comparing the values of
<code>MovedIn</code> and <code>ValidFrom</code> for row 4.</p>
<p>When using Type 2 history, this feature is correctly replicated when
reconstructing historical data:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slice_timestamp</span> <span class="op">&lt;-</span> <span class="st">"2021-03-02"</span></span>
<span></span>
<span><span class="va">addresses</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">1</span>,</span>
<span>         <span class="va">ValidFrom</span> <span class="op">&lt;</span> <span class="op">!</span><span class="op">!</span><span class="va">slice_timestamp</span>,</span>
<span>         <span class="va">ValidUntil</span> <span class="op">&gt;=</span> <span class="op">!</span><span class="op">!</span><span class="va">slice_timestamp</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ValidUntil</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ValidFrom"</span>, <span class="st">"ValidUntil"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">#&gt;      ID GivenName Surname Address        MovedIn    MovedOut</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 Alice     Doe     Donut Plains 1 1989-06-26 <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>In other words, even though Alice’s address was subsequently updated
in the registry, we can still see that she <em>was</em> registered as
living in Donut Plains at this time. This modeling of “timelines of
timelines” is also called bitemporal modeling.</p>
<p>By now, things are going well between Alice and Robert; they get
married, with Alice taking Robert’s surname. It is the same person that
has lived with Robert, but as of the day of marriage, she has a
different name:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">addresses2</span>,</span>
<span>       <span class="va">ID</span> <span class="op">==</span> <span class="fl">1</span>,</span>
<span>       <span class="va">Address</span> <span class="op">==</span> <span class="st">"Rainbow Road 8"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">GivenName</span>, <span class="va">Surname</span>, <span class="va">MovedIn</span>, <span class="va">MovedOut</span>, <span class="va">ValidFrom</span>, <span class="va">ValidUntil</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">#&gt;      ID GivenName Surname MovedIn    MovedOut ValidFrom  ValidUntil</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 Alice     Doe     2021-03-01 <span style="color: #BB0000;">NA</span>       2021-03-08 2023-08-28</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 Alice     Tables  2021-03-01 <span style="color: #BB0000;">NA</span>       2023-08-28 <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>This is now also reflected in the data; the <code>MovedIn</code> date
is persistent across the date of the name change, only the
<code>Surname</code> changes:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slice_timestamp</span> <span class="op">&lt;-</span> <span class="st">"2022-03-04"</span></span>
<span></span>
<span><span class="va">addresses2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Address</span> <span class="op">==</span> <span class="st">"Rainbow Road 8"</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">MovedOut</span><span class="op">)</span>,</span>
<span>         <span class="va">ValidFrom</span> <span class="op">&lt;</span> <span class="op">!</span><span class="op">!</span><span class="va">slice_timestamp</span>,</span>
<span>         <span class="va">ValidUntil</span> <span class="op">&gt;=</span> <span class="op">!</span><span class="op">!</span><span class="va">slice_timestamp</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ValidUntil</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">GivenName</span>, <span class="va">Surname</span>, <span class="va">MovedIn</span>, <span class="va">MovedOut</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;      ID GivenName Surname MovedIn    MovedOut</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     2 Robert    Tables  1989-12-13 <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 Alice     Doe     2021-03-01 <span style="color: #BB0000;">NA</span></span></span>
<span></span>
<span><span class="va">slice_timestamp</span> <span class="op">&lt;-</span> <span class="st">"2023-09-29"</span></span>
<span></span>
<span><span class="va">addresses2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Address</span> <span class="op">==</span> <span class="st">"Rainbow Road 8"</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">MovedOut</span><span class="op">)</span>,</span>
<span>         <span class="va">ValidFrom</span> <span class="op">&lt;</span> <span class="op">!</span><span class="op">!</span><span class="va">slice_timestamp</span>,</span>
<span>         <span class="va">ValidUntil</span> <span class="op">&gt;=</span> <span class="op">!</span><span class="op">!</span><span class="va">slice_timestamp</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ValidUntil</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">GivenName</span>, <span class="va">Surname</span>, <span class="va">MovedIn</span>, <span class="va">MovedOut</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;      ID GivenName Surname MovedIn    MovedOut</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     2 Robert    Tables  1989-12-13 <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 Alice     Tables  2021-03-01 <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>By now, it is hopefully clear how managing a slowly changing
dimension allows you to access data at any point in (tracked) time while
potentially avoiding a lot of data redundancy.</p>
<p>You are now ready to get started with the <code>SCDB</code>
package!</p>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Kimball2013" class="csl-entry">
Kimball, R., and M. Ross. 2013. <em>The Data Warehouse Toolkit: The
Definitive Guide to Dimensional Modeling</em>. Wiley.
</div>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rasmus Skytte Randløv, Marcus Munch Grünewald, Statens Serum Institut.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
